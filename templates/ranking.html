{% extends "base.html" %}


{% block content %}
<h2>Classements</h2>

<!-- üî• Menu pour choisir le classement -->
<ul class="nav nav-tabs" id="ranking-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#" onclick="showRanking('players')">Classement Caps</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" onclick="showRanking('coincoin')">Classement Coin Coin</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" onclick="showRanking('total')">Classement par √âtages Caps (Somme ELO)</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" onclick="showRanking('average')">Classement par √âtages Caps (Moyenne ELO)</a>
    </li>
</ul>

<!-- üî• Classement G√©n√©ral -->
<div id="ranking-players">
    <h3>Classement Caps</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>Pseudo</th>
                <th>√âtage</th>
                <th>Ann√©e</th>
                <th>ELO</th>
                <th>Tier</th>
            </tr>
        </thead>
        <tbody>
            {% for player in players %}
            <tr {% if player.id == current_user_id %}class="highlight"{% endif %}>
                <td>{{ loop.index }}</td>
                <td>
                    <img src="{{ url_for('static', filename='profiles/' + (player.profile_picture or 'default.png')) }}" 
                        alt="photo de profil" 
                        width="40" height="40" 
                        style="border-radius:50%; margin-right:8px;">
                    {{ player.username }}
                </td>
                
                <td>{{ player.floor }}</td>
                <td>{{ player.year }}</td>
                <td>{{ player.elo }}</td>
                <td>
                    <img src="{{ url_for('static', filename='icons/' + player.icon) }}" alt="{{ player.tier }}" width="40">
                    {{ player.tier }}
                </td>  <!-- üî• Ic√¥ne et nom du tier -->
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- üî• Classement Coin Coin -->
<div id="ranking-coincoin" style="display: none;">
    <h3>Classement Coin Coin</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>Pseudo</th>
                <th>√âtage</th>
                <th>Ann√©e</th>
                <th>ELO Coin Coin</th>
                <th>Tier</th>
            </tr>
        </thead>
        <tbody>
            {% for player in coincoin_players %}
            <tr {% if player.id == current_user_id %}class="highlight"{% endif %}>
                <td>{{ loop.index }}</td>
                <td>
                    <img src="{{ url_for('static', filename='profiles/' + (player.profile_picture or 'default.png')) }}" 
                        alt="photo de profil" 
                        width="30" height="30" 
                        style="border-radius:50%; margin-right:8px;">
                    {{ player.username }}
                </td>
                <td>{{ player.floor }}</td>
                <td>{{ player.year }}</td>
                <td>{{ player.elo }}</td>
                <td>
                    <img src="{{ url_for('static', filename='icons/' + player.icon) }}" alt="{{ player.tier }}" width="40">
                    {{ player.tier }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


<!-- üî• Classement des √âtages par Somme des ELO -->
<div id="ranking-total" style="display: none;">
    <h3>Classement des √âtages Caps (Somme des ELO)</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>√âtage</th>
                <th>Somme des ELO</th>
            </tr>
        </thead>
        <tbody>
            {% for floor, total_elo in ranking_by_total %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ floor }}</td>
                <td>{{ total_elo|round }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- üî• Classement des √âtages par Moyenne des ELO -->
<div id="ranking-average" style="display: none;">
    <h3>Classement des √âtages Caps (Moyenne des ELO)</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>√âtage</th>
                <th>Moyenne des ELO</th>
            </tr>
        </thead>
        <tbody>
            {% for floor, avg_elo in ranking_by_average %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ floor }}</td>
                <td>{{ avg_elo|round }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- üî• Script pour basculer entre les classements -->
<script>
function showRanking(type) {
    document.getElementById("ranking-players").style.display = "none";
    document.getElementById("ranking-coincoin").style.display = "none";
    document.getElementById("ranking-total").style.display = "none";
    document.getElementById("ranking-average").style.display = "none";

    document.getElementById("ranking-" + type).style.display = "block";

    let tabs = document.getElementById("ranking-tabs").getElementsByClassName("nav-link");
    for (let tab of tabs) {
        tab.classList.remove("active");
    }
    event.target.classList.add("active");
}
</script>

{% endblock %}