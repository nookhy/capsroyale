{% extends "base.html" %}

{% block content %}
<h2>Classements</h2>

<!-- üî• Menu pour choisir le classement -->
<ul class="nav nav-tabs" id="ranking-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#" onclick="showRanking('players')">Classement G√©n√©ral</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" onclick="showRanking('total')">Classement par √âtages (Somme ELO)</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" onclick="showRanking('average')">Classement par √âtages (Moyenne ELO)</a>
    </li>
</ul>

<!-- üî• Classement G√©n√©ral -->
<div id="ranking-players">
    <h3>Classement G√©n√©ral</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>Pseudo</th>
                <th>√âtage</th>
                <th>Ann√©e</th>
                <th>ELO</th>
            </tr>
        </thead>
        <tbody>
            {% for player in players %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ player.username }}</td>
                <td>{{ player.floor }}</td>
                <td>{{ player.year }}</td>
                <td>{{ player.elo }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- üî• Classement des √âtages par Somme des ELO -->
<div id="ranking-total" style="display: none;">
    <h3>Classement des √âtages (Somme des ELO)</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>√âtage</th>
                <th>Somme des ELO</th>
            </tr>
        </thead>
        <tbody>
            {% for floor, total_elo in ranking_by_total %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ floor }}</td>
                <td>{{ total_elo|round }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- üî• Classement des √âtages par Moyenne des ELO -->
<div id="ranking-average" style="display: none;">
    <h3>Classement des √âtages (Moyenne des ELO)</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Rang</th>
                <th>√âtage</th>
                <th>Moyenne des ELO</th>
            </tr>
        </thead>
        <tbody>
            {% for floor, avg_elo in ranking_by_average %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ floor }}</td>
                <td>{{ avg_elo|round }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- üî• Script pour basculer entre les classements -->
<script>
function showRanking(type) {
    document.getElementById("ranking-players").style.display = "none";
    document.getElementById("ranking-total").style.display = "none";
    document.getElementById("ranking-average").style.display = "none";

    if (type === "players") {
        document.getElementById("ranking-players").style.display = "block";
    } else if (type === "total") {
        document.getElementById("ranking-total").style.display = "block";
    } else if (type === "average") {
        document.getElementById("ranking-average").style.display = "block";
    }

    let tabs = document.getElementById("ranking-tabs").getElementsByClassName("nav-link");
    for (let tab of tabs) {
        tab.classList.remove("active");
    }
    event.target.classList.add("active");
}
</script>

{% endblock %}